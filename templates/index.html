<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deletor Automático · Content Server</title>
  <style>
    /* ========= Tokens ========= */
    :root{
      --bg: #0c0c0d;
      --bg-accent: radial-gradient(1000px 600px at 10% -10%, #343a50 0%, transparent 55%),
                   radial-gradient(800px 500px at 110% 0%, #4b2f3a 0%, transparent 55%),
                   #0c0c0d;
      --panel: rgba(22,22,24,.72);
      --panel-soft: rgba(28,28,30,.55);
      --border: rgba(255,255,255,.10);
      --text: #f5f5f7;
      --muted: #9ea0a6;
      --brand: #1e90ff;
      --brand-strong:#166fd1;
      --ok:#18a05e;
      --error:#ff4d4f;
      --radius-xl: 24px; --radius-lg: 16px; --radius-md: 12px;
      --shadow: 0 22px 60px rgba(0,0,0,.45), 0 2px 6px rgba(0,0,0,.28);
      --glass: blur(14px);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f5f5f7;
        --bg-accent: radial-gradient(900px 540px at -10% -10%, #eaf1ff 0%, transparent 55%),
                     radial-gradient(900px 540px at 110% 0%, #ffeaf1 0%, transparent 55%),
                     #f5f5f7;
        --panel: rgba(255,255,255,.86);
        --panel-soft: rgba(255,255,255,.70);
        --border: rgba(0,0,0,.08);
        --text: #1d1d1f; --muted:#6e6e73;
        --shadow: 0 22px 60px rgba(0,0,0,.10), 0 2px 6px rgba(0,0,0,.05);
      }
    }

    /* ========= Base ========= */
    *{box-sizing:border-box}
    html,body{height:100%}
    ::selection{background: rgba(30,144,255,.35); color:#fff}
    body{
      margin:0;
      font: 16px/1.55 -apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background: var(--bg-accent);
    }

    /* ========= Topbar ========= */
    .topbar{
      position: fixed; inset: 14px 14px auto 14px; height:56px;
      display:flex; align-items:center; gap:12px; padding:10px 14px;
      background: var(--panel); border:1px solid var(--border);
      backdrop-filter: var(--glass); border-radius: 16px; box-shadow: var(--shadow);
    }
    .dot{width:12px;height:12px;border-radius:50%;
      background: linear-gradient(135deg, var(--brand), #7ab8ff);
      box-shadow: 0 0 0 4px rgba(30,144,255,.12);}
    .brand{font-weight:700; letter-spacing:.2px}

    /* ========= Layout ========= */
    .wrap{min-height:100%; display:flex; align-items:center; justify-content:center; padding:110px 20px 60px;}
    .card{
      width:min(1060px, 96vw);
      background: var(--panel); border:1px solid var(--border); border-radius: var(--radius-xl);
      box-shadow: var(--shadow); backdrop-filter: var(--glass); overflow:hidden; animation:up .5s ease both;
    }
    @keyframes up{from{opacity:0; transform: translateY(10px)} to{opacity:1; transform:none}}

    .grid{
      display:grid; grid-template-columns: 1.2fr 1fr; gap:32px; padding:46px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns: 1fr; padding:26px}
    }

    .title{font-size: clamp(28px,4.8vw,44px); line-height:1.12; margin:6px 0 10px; font-weight:800}
    .subtitle{color:var(--muted); font-size:1.05rem; margin:0 0 18px}
    .pills{display:flex; flex-wrap:wrap; gap:10px; margin: 8px 0 0}
    .pill{
      border:1px solid var(--border); background: var(--panel-soft);
      padding:8px 12px; border-radius:999px; font-size:.88rem; display:inline-flex; align-items:center; gap:8px;
    }
    .pill svg{opacity:.9}

    /* ========= Upload ========= */
    .panel{background: var(--panel-soft); border:1px solid var(--border); border-radius: var(--radius-lg); padding:22px;}
    .drop{
      position:relative; border:2px dashed rgba(255,255,255,.16); border-radius: var(--radius-lg);
      padding:26px; text-align:center; transition: border-color .2s ease, box-shadow .2s ease, transform .08s ease;
      background: linear-gradient(180deg, transparent, rgba(255,255,255,.04));
      cursor: pointer;
    }
    @media (prefers-color-scheme: light){
      .drop{border-color: rgba(0,0,0,.12); background: linear-gradient(180deg, transparent, rgba(0,0,0,.02))}
    }
    .drop:hover{transform: translateY(-1px)}
    .drop.drag{border-color: var(--brand); box-shadow: 0 0 0 6px rgba(30,144,255,.12)}
    .drop input[type=file]{position:absolute; inset:0; opacity:0; cursor:pointer}
    .drop h3{margin:6px 0 2px; font-size:1.05rem}
    .drop p{margin:0; color:var(--muted); font-size:.92rem}

    .chip{
      display:none; margin-top:14px; justify-content:center; align-items:center; gap:10px;
      padding:10px 12px; border-radius: 12px; border:1px solid var(--border);
      background: rgba(30,144,255,.10); color:#dbe9ff; font-size:.92rem;
    }
    @media (prefers-color-scheme: light){
      .chip{background: rgba(30,144,255,.10); color:#0a2b52}
    }
    .chip.show{display:flex}
    .chip.error{background: rgba(255,77,79,.1); color:#ffd7d7}

    .actions{display:flex; gap:12px; margin-top:18px; justify-content:center}
    .btn{
      appearance:none; border:none; cursor:pointer; user-select:none;
      background: var(--brand); color:#fff; font-weight:700; letter-spacing:.2px;
      padding: 12px 22px; border-radius: 999px; font-size:1rem;
      transition: transform .06s ease, box-shadow .2s ease, background .2s ease;
      box-shadow: 0 12px 28px rgba(30,144,255,.25);
    }
    .btn:hover{background: var(--brand-strong)}
    .btn:active{transform: translateY(1px)}
    .btn[disabled]{opacity:.55; cursor:not-allowed; box-shadow:none}
    .btn.secondary{
      background: transparent; color: var(--text); border:1px solid var(--border); box-shadow:none;
    }
    .btn.secondary:hover{background: rgba(255,255,255,.06)}

    .spinner{width:16px; height:16px; border-radius:50%; border:2px solid rgba(255,255,255,.5); border-top-color:#fff;
      display:none; vertical-align:-3px; margin-right:8px; animation: spin .8s linear infinite;}
    @keyframes spin{to{transform: rotate(360deg)}}

    /* ========= Features ========= */
    .features{display:grid; grid-template-columns: repeat(3,1fr); gap:16px; padding: 0 46px 38px;}
    @media (max-width: 900px){ .features{grid-template-columns: 1fr; padding: 0 26px 26px} }
    .tile{background: var(--panel-soft); border:1px solid var(--border); border-radius: var(--radius-md); padding:18px;}
    .tile h4{margin:2px 0 6px; font-size:1rem}
    .tile p{margin:0; color:var(--muted); font-size:.94rem}

    .foot{color:var(--muted); text-align:center; font-size:.88rem; padding: 0 26px 26px}
  </style>
</head>
<body>
  <header class="topbar" role="banner">
    <span class="dot" aria-hidden="true"></span>
    <strong class="brand">Deletor Automático</strong>
  </header>

  <main class="wrap">
    <section class="card" aria-labelledby="title">
      <div class="grid">
        <!-- Coluna esquerda -->
        <div>
          <h1 id="title" class="title">Exclua usuários com precisão — sem sustos.</h1>
          <p class="subtitle">Envie o CSV, visualize uma amostra, valide e siga. Minimalista, objetivo, rápido.</p>
          <div class="pills">
            <span class="pill">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M5 12l4 4L19 6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
              Validação de formato
            </span>
            <span class="pill">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M12 8v8m4-4H8" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg>
              Preview seguro
            </span>
            <span class="pill">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M3 12h18" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg>
              Fluxo simples
            </span>
          </div>
        </div>

        <!-- Coluna direita (upload) -->
        <form class="panel" id="uploadForm" action="/upload" method="POST" enctype="multipart/form-data" novalidate>
          <div class="drop" id="drop">
            <input id="file" name="file" type="file" accept=".csv" aria-label="Selecionar arquivo CSV">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M14 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8l-5-5z" stroke="currentColor" stroke-width="1.2"/>
              <path d="M14 3v5h5" stroke="currentColor" stroke-width="1.2"/>
            </svg>
            <h3>Arraste e solte seu CSV</h3>
            <p>ou clique para selecionar</p>
          </div>

          <div class="chip" id="chip"><span id="chipText">Nenhum arquivo selecionado</span></div>

          <div class="actions">
            <button class="btn" id="submitBtn" type="submit" disabled>
              <span class="spinner" id="spinner"></span>
              Enviar CSV
            </button>
            <a class="btn secondary" href="/static/template.csv" download>Baixar template</a>
          </div>

          <div id="preview" class="tile" style="margin-top:16px; display:none;">
            <h4>Prévia (primeiras linhas)</h4>
            <div id="table" style="margin-top:8px; overflow:auto; max-height:160px; border:1px dashed var(--border); border-radius:10px;"></div>
          </div>
        </form>
      </div>

      <div class="features" aria-hidden="true">
        <div class="tile"><h4>Privacidade</h4><p>Sem expor credenciais na UI. Processamento apenas no servidor.</p></div>
        <div class="tile"><h4>Performance</h4><p>Lotes com feedback claro e fluido. Nada de travar tela.</p></div>
        <div class="tile"><h4>Confiabilidade</h4><p>Validações, pré-visualização e proteção contra ações acidentais.</p></div>
      </div>

      <p class="foot">© <span id="year"></span> Deletor Automático</p>
    </section>
  </main>

  <script>
    const $ = (q)=>document.querySelector(q);
    const drop = $('#drop');
    const input = $('#file');
    const chip = $('#chip');
    const chipText = $('#chipText');
    const submitBtn = $('#submitBtn');
    const spinner = $('#spinner');
    const preview = $('#preview');
    const table = $('#table');
    $('#year').textContent = new Date().getFullYear();

    function setChip(text, isError=false){
      chip.classList.add('show');
      chip.classList.toggle('error', !!isError);
      chipText.textContent = text;
    }

    function enableSubmit(ok){
      submitBtn.disabled = !ok;
    }

    function parseCSVPreview(file, maxLines=8){
      const reader = new FileReader();
      reader.onload = (e)=>{
        const text = e.target.result || '';
        const lines = text.split(/\r?\n/).slice(0, maxLines).filter(Boolean);
        if(!lines.length){ preview.style.display='none'; return; }
        const cells = lines.map(l => l.split(','));
        // Render simples
        let html = '<table style="width:100%; border-collapse:collapse; font-size:.92rem">';
        cells.forEach((row,i)=>{
          html += `<tr style="${i===0?'font-weight:700':''}">` +
                  row.map(c=>`<td style="padding:8px 10px; border-bottom:1px solid var(--border); white-space:nowrap;">${c.replace(/</g,'&lt;')}</td>`).join('') +
                  `</tr>`;
        });
        html += '</table>';
        table.innerHTML = html;
        preview.style.display = 'block';
      };
      reader.readAsText(file);
    }

    function handleFile(file){
      if(!file) return;
      if(!/\.csv$/i.test(file.name)){
        setChip('Formato inválido. Selecione um arquivo .csv', true);
        enableSubmit(false); preview.style.display='none'; return;
      }
      // coloca o arquivo no input (para envio real do form)
      const dt = new DataTransfer();
      dt.items.add(file);
      input.files = dt.files;

      setChip(`${file.name} • ${(file.size/1024).toFixed(1)} KB`);
      enableSubmit(true);
      parseCSVPreview(file);
    }

    // DnD sólido
    ['dragenter','dragover'].forEach(evt=>{
      drop.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); drop.classList.add('drag'); });
    });
    ['dragleave','drop'].forEach(evt=>{
      drop.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); drop.classList.remove('drag'); });
    });
    drop.addEventListener('drop', e=>{
      const f = e.dataTransfer.files && e.dataTransfer.files[0];
      handleFile(f);
    });

    // Clique/seleção
    input.addEventListener('change', e=> handleFile(e.target.files[0]));

    // Estado de loading (somente UI; backend fará o upload real)
    $('#uploadForm').addEventListener('submit', ()=>{
      spinner.style.display = 'inline-block';
      submitBtn.setAttribute('disabled','disabled');
    });
  </script>
</body>
</html>
